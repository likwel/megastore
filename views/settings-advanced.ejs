
<!DOCTYPE html>
<html lang="en">

<meta http-equiv="content-type" content="text/html;charset=UTF-8" />

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>MegaStore - Paramètre avancé</title>
    <meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no">
    <meta name="title" content="Spaces - My Account">
    <meta name="author" content="Themesberg">
    <meta name="description"
        content="Premium Directory Listing Bootstrap 4 Template featuring 37 hand-crafted pages, a dashboard an Mapbox integration. Spaces also comes with a complete UI Kit featuring over 700 components by Themesberg.">
    <meta name="keywords"
        content="bootstrap, bootstrap 4 template, directory listing bootstrap, bootstrap 4 listing, bootstrap listing, bootstrap 4 directory listing template, vector map, leaflet js template, mapbox theme, mapbox template, dashboard, themesberg, user dashboard bootstrap, dashboard bootstrap, ui kit, bootstrap ui kit, premium bootstrap theme">
    <link rel="canonical" href="https://themesberg.com/product/bootstrap/spaces-bootstrap-directory-listing-template">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://demo.themesberg.com/pixel-pro">
    <meta property="og:title" content="Spaces - My Account">
    <meta property="og:description"
        content="Premium Directory Listing Bootstrap 4 Template featuring 37 hand-crafted pages, a dashboard an Mapbox integration. Spaces also comes with a complete UI Kit featuring over 700 components by Themesberg.">
    <meta property="og:image"
        content="../../../../../themesberg.s3.us-east-2.amazonaws.com/public/products/spaces/thumbnail.jpg">
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://demo.themesberg.com/pixel-pro">
    <meta property="twitter:title" content="Spaces - My Account">
    <meta property="twitter:description"
        content="Premium Directory Listing Bootstrap 4 Template featuring 37 hand-crafted pages, a dashboard an Mapbox integration. Spaces also comes with a complete UI Kit featuring over 700 components by Themesberg.">
    <meta property="twitter:image"
        content="../../../../../themesberg.s3.us-east-2.amazonaws.com/public/products/spaces/thumbnail.jpg">
    <link rel="apple-touch-icon" sizes="120x120"
        href="https://demo.themesberg.com/bootstrap/spaces/assets/img/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32"
        href="https://demo.themesberg.com/bootstrap/spaces/assets/img/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16"
        href="https://demo.themesberg.com/bootstrap/spaces/assets/img/favicon/favicon-16x16.png">

    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="theme-color" content="#ffffff">

    <%- include('style'); %>

</head>

<body>
    
    <%- include('component/header', {classNav : "navbar-light navbar-theme-primary"}); %>
    <main>
        
        <div class="section section-lg bg-soft">
            <div class="container">
                <div class="row pt-5 pt-md-0">

                    <%- include('component/profile-left', { dashboard:"", settings:"active", items:"", product:"", security:"", belling :"", message:""}); %>

                    <div class="col-12 col-lg-8">
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="card card-body bg-white border-light mb-4 <%=JSON.parse(user).types=='client'?'d-none':''%>">
                                    <h2 class="h5 mb-4">Dragger le marker pour modifier la position.</h2>
                                    <div class="form-group row mb-0">
                                        <div class="col-4 form-group">
                                            <div class="input-group mb-4">
                                                <div class="input-group-prepend"><span class="input-group-text">Lat <i class="ml-1 fa-solid fa-location-crosshairs"></i></span></div><input
                                                    class="form-control" id="lat" placeholder="Latitude" value="<%=vendor?JSON.parse(vendor).latitude:'0' %>"
                                                    type="text" autocomplete="on" name="nif">
                                            </div>
                                        </div>
                                        <div class="col-4 form-group">
                                            <div class="input-group">
                                                <div class="input-group-prepend"><span class="input-group-text">Lon <i class="ml-1 fa-solid fa-location-crosshairs"></i></span>
                                                </div><input
                                                    class="form-control" id="long" value="<%=vendor?JSON.parse(vendor).longitude:'0' %>"
                                                    placeholder="Longitude" type="text" autocomplete="on" name="stat">
                                            </div>
                                        </div>
                                        <div class="col-4 form-group">
                                            <div class="input-group">
                                                <div class="input-group-prepend"></div>
                                                <button type="button" id="setloc" class="btn btn-block btn-primary" disabled onclick="saveLatLon()"><i class="fa-solid fa-floppy-disk"></i> Appliquer</button>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-12 p-0" style="width: 100%; height: 100%;">
                                        <div id="map-location" style="width: 100%; height: 400px;">

                                        </div>
                                    </div>
                                </div>
                                <div class="card card-body bg-white border-light">
                                    <h2 class="h5 mb-4">Paramètre de position</h2>
                                    <ul class="list-group list-group-flush">
                                        <li class="list-group-item d-flex justify-content-between pl-0 border-bottom">
                                            <div>
                                                <h3 class="h6 mb-1">Position de géolocalisation</h3><span class="small">Notre site web utilise la technologie de géolocalisation GPS pour offrir des fonctionnalités basées sur la localisation et améliorer votre expérience utilisateur. En autorisant l'accès à votre position géographique, nous sommes en mesure de fournir des services personnalisés et des informations pertinentes en fonction de votre emplacement actuel.</span>
                                            </div>
                                            <div>
                                                <div class="custom-control custom-switch"><input type="checkbox"
                                                        class="custom-control-input" id="shop-notification-1"
                                                        checked="checked"> <label class="custom-control-label"
                                                        for="shop-notification-1"></label></div>
                                            </div>
                                        </li>
                                        <li class="list-group-item d-flex justify-content-between pl-0 border-bottom">
                                            <div>
                                                <h3 class="h6 mb-1">Paramètres de cookies</h3><span class="small">Notre site web utilise des cookies pour offrir une expérience utilisateur optimale et personnalisée. Les cookies sont de petits fichiers texte qui sont placés sur votre appareil lorsque vous visitez notre site. Ils servent à mémoriser vos préférences de navigation, à améliorer les performances du site et à fournir des fonctionnalités essentielles.

                                                    En utilisant notre site web, vous consentez à l'utilisation de cookies conformément à cette politique. Vous pouvez contrôler et gérer l'acceptation des cookies dans les paramètres de votre navigateur. Cependant, veuillez noter que la désactivation des cookies peut affecter certaines fonctionnalités du site et limiter votre expérience utilisateur.</span>
                                            </div>
                                            <div>
                                                <div class="custom-control custom-switch"><input type="checkbox" checked="checked"
                                                        class="custom-control-input" id="shop-notification-2"> <label
                                                        class="custom-control-label" for="shop-notification-2"></label>
                                                </div>
                                            </div>
                                        </li>
                                        <li class="list-group-item d-flex justify-content-between pl-0">
                                            <div>
                                                <h3 class="h6 mb-1">Paramètres de cache et images</h3><span class="small">Afin d'améliorer la vitesse de chargement et l'efficacité de notre site web, nous utilisons une technologie de mise en cache pour les images. Le cache permet de stocker temporairement les images sur votre appareil lors de votre visite sur notre site. Cela signifie que les images que vous avez déjà chargées une fois seront récupérées localement à partir de votre navigateur ou de votre appareil lors de vos prochaines visites, ce qui réduit le temps de chargement des pages et améliore votre expérience utilisateur.</span>
                                            </div>
                                            <div>
                                                <div class="custom-control custom-switch"><input type="checkbox"
                                                        class="custom-control-input" id="shop-notification-3"
                                                        checked="checked"> <label class="custom-control-label"
                                                        for="shop-notification-3"></label></div>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <%- include('component/footer'); %>
    <%- include('script'); %>

    <script>

        var vendor = '<%-JSON.stringify(vendor)%>';

        vendor = vendor.substring(1);
        vendor = JSON.parse(vendor.slice(0, -1));

        var config = {
                mapboxToken: 'pk.eyJ1Ijoiem9sdGFudGhlbWVzYmVyZyIsImEiOiJjazZqaWUwcWswYTBvM21td2Jmcm5mYmdyIn0.7_5YCbbOFRnvqZzCNDo9fw',
                // mapboxId: 'mapbox/light-v10'
                mapboxId: 'mapbox/streets-v10'
            };

        let lat = vendor.latitude!=0?vendor.latitude:-18.91368;
        let long = vendor.longitude!=0?vendor.longitude:47.53613;


        var baseLatLng = [lat,long];
        var zoom = 10;

        var icon = L.icon({
            iconUrl: '../assets/images/marker.png',
            // iconSize:     [38, 95], // size of the icon
            iconSize:     [38, 40], // size of the icon
            shadowSize:   [50, 64], // size of the shadow
            // iconAnchor:   [22, 94], // point of the icon which will correspond to marker's location
            iconAnchor:   [22, 38], // point of the icon which will correspond to marker's location
            shadowAnchor: [4, 62],  // the same for the shadow
            popupAnchor:  [-3, -76] // point from which the popup should open relative to the iconAnchor
        });

        // modal listing view
        var mapListings = L.map('map-location').setView(baseLatLng, zoom);
        L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}', {
            attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
            maxZoom: 18,
            id: config.mapboxId,
            accessToken: config.mapboxToken
        }).addTo(mapListings);

        var marker = L.marker(baseLatLng, { icon: icon, draggable:'true'}).addTo(mapListings);

        mapListings.setView(baseLatLng, zoom);

        marker.on('dragend', function(event) {
            var position = marker.getLatLng();
            marker.setLatLng(position, {
            draggable: 'true'
        }).bindPopup(position).update();
        $("#lat").val(position.lat);
        $("#long").val(position.lng).keyup();
        document.querySelector("#setloc").disabled = false;
    });

    function saveLatLon(){

        var lat = document.querySelector("#lat").value;
        var long = document.querySelector("#long").value;

        // console.log(JSON.parse(vendor));

        fetch("/set-lat-long?lat=" + lat + "&lon=" + long +"&id="+vendor.id, {
            method: "POST",
        })
        .then(r=>{
            console.log(r);
            if(r.status==200){
                alert("latlong à jour");
            }

        })
        document.querySelector("#setloc").disabled = true;

    }

    </script>
</body>

</html>